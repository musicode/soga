!function(n,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports):"function"==typeof define&&define.amd?define(["exports"],o):o((n=n||self).Soga={})}(this,function(n){"use strict";function o(n){var o=[],e=[],t=[];return n.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(n,a,u){return o.push(a=a.toLowerCase()),e.push(u),t.push([a,u]),n}),function(n,o,e,t){return function a(){return{ok:2==(n.status/100|0),statusText:n.statusText,status:n.status,url:n.responseURL,headers:{keys:function(){return o},values:function(){return e},entries:function(){return t}},text:function(){return n.responseText},json:function(){return JSON.parse(n.responseText)},blob:function(){return new Blob([n.response])},clone:a}}}(n,o,e,t)}function e(n,o){for(var e in o)n.setRequestHeader(e,o[e])}var t=File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice,a=function(n,e){var t=this;t.file=n,t.hooks=e,t.fileSize=n.size;var a=t.xhr=new XMLHttpRequest;a.upload.onloadstart=function(){e.onUploadStart&&e.onUploadStart()},a.upload.onloadend=function(){e.onUploadEnd&&e.onUploadEnd()},a.upload.onload=function(){var n=t.fileSize,u=t.chunkInfo;if(u&&u.uploaded<n&&(u.uploaded+=u.uploading,e.onUploadChunkSuccess&&e.onUploadChunkSuccess({chunkIndex:u.options.chunkIndex}),u.uploaded<n))return u.options.chunkIndex++,void t.uploadChunk(u.options);if(e.onUploadSuccess){var r=o(a);e.onUploadSuccess(r())}},a.upload.onerror=function(){e.onUploadFailure&&e.onUploadFailure()},a.upload.onabort=function(){e.onUploadCancel&&e.onUploadCancel()},a.upload.onprogress=function(n){var o,a=t.fileSize,u=t.chunkInfo;if(u){var r=u.uploading,s=Math.min(r,n.loaded);e.onUploadChunkProgress&&e.onUploadChunkProgress({chunkIndex:u.options.chunkIndex,uploaded:s,total:r,percent:r>0?s/r:0}),o=u.uploaded+s}else o=Math.min(a,n.loaded);e.onUploadProgress&&e.onUploadProgress({uploaded:o,total:a,percent:a>0?o/a:0})}};a.support=function(){var n=new XMLHttpRequest;return n&&"upload"in n&&"onprogress"in n.upload},a.prototype.upload=function(n){var o=this.xhr,t=this.file;e(o,n.headers);var a=new FormData;for(var u in n.data)a.append(u,n.data[u]);a.append(n.fileName,t),o.open("post",n.action,!0),o.send(a)},a.prototype.uploadChunk=function(n){var o=this.xhr,a=this.file,u=this.fileSize,r=this.chunkInfo;r?r.options!==n&&(r.options=n):r=this.chunkInfo={uploaded:0,uploading:0,options:n};var s=n.chunkIndex||0,i=n.chunkSize||4194304,d=i*s,p=Math.min(u,i*(s+1));r.uploading=p-d,e(o,{Range:"bytes "+d+"-"+p+"/"+u}),e(o,n.headers),o.open("post",n.action,!0),o.send(t.call(a,d,p))},n.AjaxUploader=a,n.fetch=function(n,t){return void 0===t&&(t={}),new Promise(function(a,u){var r=new XMLHttpRequest;r.open(t.method||"get",n,!0),r.onload=function(){var n=o(r);a(n())},r.onerror=u,r.withCredentials="include"===t.credentials,e(r,t.headers),r.send(t.body||null)})},Object.defineProperty(n,"__esModule",{value:!0})});
//# sourceMappingURL=soga.min.js.map
