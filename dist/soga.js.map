{"version":3,"file":"soga.js","sources":["../src/function/createResponse.ts","../src/function/parseResponse.ts","../src/function/setRequestHeaders.ts","../src/fetch.ts","../src/AjaxUploader.ts","../src/supload/Supload.ts"],"sourcesContent":["import * as type from '../type'\n\nexport default function (\n  xhr: XMLHttpRequest,\n  headers: Record<string, string>\n) {\n  function response(): type.Response {\n    return {\n      ok: xhr.status >= 200 && xhr.status < 300,\n      statusText: xhr.statusText || 'OK',\n      status: xhr.status || 200,\n      url: xhr.responseURL || headers['x-request-url'] || '',\n      headers: {\n        get(name: string) {\n          return headers[name.toLowerCase()]\n        },\n        has(name: string) {\n          return name.toLowerCase() in headers\n        }\n      },\n      body: xhr.response || xhr.responseText,\n      text() {\n        return xhr.responseText\n      },\n      json() {\n        return JSON.parse(xhr.responseText)\n      },\n      blob() {\n        return new Blob([xhr.response])\n      },\n      clone: response,\n    }\n  }\n  return response\n}","import createResponse from './createResponse'\n\nexport default function (xhr: XMLHttpRequest) {\n\n  const headers: Record<string, string> = {}\n\n  const rawHeaders = xhr.getAllResponseHeaders() || ''\n\n  rawHeaders.replace(\n    /^(.*?):[^\\S\\n]*([\\s\\S]*?)$/gm,\n    function (match: string, key: string, value: string) {\n      headers[key.toLowerCase()] = value\n      return match\n    }\n  )\n\n  return createResponse(xhr, headers)\n\n}","export default function (xhr: XMLHttpRequest, headers?: HeadersInit) {\n  for (let key in headers) {\n    xhr.setRequestHeader(key, headers[key])\n  }\n}","import parseResponse from './function/parseResponse'\nimport setRequestHeaders from './function/setRequestHeaders'\n\nexport default function (url: string, options: RequestInit = {}) {\n  return new Promise(function (resolve, reject) {\n\n    const xhr = new XMLHttpRequest()\n\n    xhr.open(options.method || 'get', url, true)\n\n    xhr.onload = function () {\n      const response = parseResponse(xhr)\n      resolve(response())\n    }\n\n    xhr.onerror = reject\n\n    /**\n     * The credentials indicates whether the user agent should send cookies\n     * from the other domain in the case of cross-origin requests.\n     *\n     * omit: Never send or receive cookies\n     *\n     * include: Always send user credentials (cookies, basic http auth, etc..), even for cross-origin calls\n     *\n     * same-origin: Send user credentials (cookies, basic http auth, etc..) if the URL is on the same origin as the calling script.\n     *              This is the default value.\n     */\n    if (options.credentials === 'include') {\n      xhr.withCredentials = true\n    }\n    else if (options.credentials === 'omit') {\n      xhr.withCredentials = false\n    }\n\n    setRequestHeaders(xhr, options.headers)\n\n    xhr.send(options.body || null)\n\n  })\n}","import * as type from './type'\nimport parseResponse from './function/parseResponse'\nimport setRequestHeaders from './function/setRequestHeaders'\n\nconst blobSlice = File.prototype['mozSlice'] || File.prototype['webkitSlice'] || File.prototype.slice\n\nexport default class AjaxUploader implements type.Uploader {\n\n  xhr: XMLHttpRequest\n\n  file: File\n  fileSize: number\n\n  hooks: type.UploadHooks\n\n  chunkInfo?: type.ChunkInfo\n\n  public static support() {\n    const xhr = new XMLHttpRequest()\n    return xhr && 'upload' in xhr && 'onprogress' in xhr.upload\n  }\n\n  constructor(file: File, hooks: type.UploadHooks) {\n\n    const instance = this\n\n    instance.file = file\n    instance.hooks = hooks\n\n    // 碰到过传了几个分片之后，file.size 变成 0 的情况\n    // 因此先存一下最初的 fileSize\n    instance.fileSize = file.size || 0\n\n    const xhr = instance.xhr = new XMLHttpRequest()\n\n    xhr.onloadstart = function () {\n      if (hooks.onStart) {\n        hooks.onStart()\n      }\n    }\n    xhr.onloadend = function () {\n      if (hooks.onEnd) {\n        hooks.onEnd()\n      }\n    }\n    xhr.onload = function () {\n\n      const { fileSize, chunkInfo } = instance\n\n      if (chunkInfo) {\n        if (chunkInfo.uploaded < fileSize) {\n          chunkInfo.uploaded += chunkInfo.uploading\n\n          if (hooks.onChunkSuccess) {\n            hooks.onChunkSuccess({\n              chunkIndex: chunkInfo.options.chunkIndex\n            })\n          }\n\n          // 还有分片没上传完则继续上传下一个\n          if (chunkInfo.uploaded < fileSize) {\n            chunkInfo.options.chunkIndex++\n            instance.uploadChunk(chunkInfo.options)\n            return\n          }\n        }\n      }\n\n      if (hooks.onSuccess) {\n        const response = parseResponse(xhr)\n        hooks.onSuccess(response())\n      }\n\n    }\n    xhr.onerror = function () {\n      if (hooks.onError) {\n        hooks.onError()\n      }\n    }\n    xhr.onabort = function () {\n      if (hooks.onAbort) {\n        hooks.onAbort()\n      }\n    }\n    // 下载文件触发的是 xhr.onprogress\n    // 上传文件触发的是 xhr.upload.onprogress\n    xhr.upload.onprogress = function (event) {\n\n      const { fileSize, chunkInfo } = instance\n\n      let uploaded: number\n\n      if (chunkInfo) {\n        // 当前正在上传的分片 size\n        const chunkTotal = chunkInfo.uploading\n        // 不能比当前正在上传的 size 还大\n        const chunkUploaded = Math.min(chunkTotal, event.loaded)\n\n        if (hooks.onChunkProgress) {\n          hooks.onChunkProgress({\n            chunkIndex: chunkInfo.options.chunkIndex,\n            uploaded: chunkUploaded,\n            total: chunkTotal,\n            // 怕浏览器有 bug 导致 chunkTotal 为 0\n            percent: chunkTotal > 0 ? chunkUploaded / chunkTotal : 0\n          })\n        }\n\n        // 加上之前上传成功的分片 size\n        uploaded = chunkInfo.uploaded + chunkUploaded\n\n      }\n      else {\n        // 不能比文件 size 还大\n        uploaded = Math.min(fileSize, event.loaded)\n      }\n\n      if (hooks.onProgress) {\n        hooks.onProgress({\n          uploaded,\n          total: fileSize,\n          // 怕浏览器有 bug 导致 fileSize 为 0\n          percent: fileSize > 0 ? uploaded / fileSize : 0\n        })\n      }\n\n    }\n\n  }\n\n  /**\n   * 上传整个文件\n   */\n  upload(options: type.UploadOptions) {\n\n    const { xhr, file } = this\n\n    xhr.open('post', options.action, true)\n\n    const formData = new FormData()\n\n    for (let key in options.data) {\n      formData.append(key, options.data[key])\n    }\n\n    formData.append(options.fileName, file)\n\n    setRequestHeaders(xhr, options.headers)\n\n    xhr.send(formData)\n\n  }\n\n  /**\n   * 上传文件分片\n   */\n  uploadChunk(options: type.UploadChunkOptions) {\n\n    let { xhr, file, fileSize, chunkInfo } = this\n\n    if (!chunkInfo) {\n      chunkInfo = this.chunkInfo = {\n        uploaded: 0,\n        uploading: 0,\n        options,\n      }\n    }\n    else if (chunkInfo.options !== options) {\n      chunkInfo.options = options\n    }\n\n    // 默认从第一个分片开始上传，断点续传可以传入指定的分片\n    const chunkIndex = options.chunkIndex || 0\n\n    // 默认一个分片为 4M\n    const chunkSize = options.chunkSize || 4 * 1024 * 1024\n\n    const start = chunkSize * chunkIndex\n    const end = Math.min(fileSize, chunkSize * (chunkIndex + 1))\n\n    chunkInfo.uploading = end - start\n\n    xhr.open('post', options.action, true)\n\n    // xhr.setRequestHeader 必须在 open() 方法之后，send() 方法之前调用，否则会报错\n\n    // xhr.setRequestHeader 设置相同的请求头不会覆盖，而是追加，如 key: value1, value2\n    // 这里改成覆盖\n    const headers = {\n      Range: `bytes ${start}-${end}/${fileSize}`\n    }\n\n    for (let key in options.headers) {\n      headers[key] = options.headers[key]\n    }\n\n    setRequestHeaders(xhr, headers)\n\n    xhr.send(blobSlice.call(file, start, end))\n\n  }\n\n  /**\n   * 取消上传\n   */\n  abort() {\n    this.xhr.abort()\n  }\n\n}","import * as type from '../type'\r\n\r\ninterface IndexedFile {\r\n  index: number\r\n  status: number\r\n  name: string\r\n  type: string\r\n  size: number\r\n}\r\n\r\ninterface FlashDebug {\r\n  text: string\r\n}\r\n\r\ninterface FlashFile {\r\n  file: IndexedFile\r\n}\r\n\r\ninterface FlashSuccess {\r\n  file: IndexedFile\r\n  responseText: string\r\n}\r\n\r\ninterface FlashError {\r\n  file: IndexedFile,\r\n  code: number,\r\n  detail: Object | void\r\n}\r\n\r\ninterface FlashProgress {\r\n  file: IndexedFile\r\n  uploaded: number\r\n  total: number\r\n}\r\n\r\ninterface SuploadOptions {\r\n  // swf 文件所在地址\r\n  swfUrl: string\r\n  // 可上传的文件格式，如 'jpg,png'\r\n  accept?: string\r\n  // 是否支持多文件上传\r\n  multiple?: boolean\r\n  // 是否开启调试模式\r\n  debug?: boolean\r\n  // 放置 <object> 标签的占位元素\r\n  el: Element\r\n}\r\n\r\ninterface SuploadHooks {\r\n  onReady?: () => void\r\n  onFileChange?: () => void\r\n  onStart?: (file: IndexedFile) => void\r\n  onEnd?: (file: IndexedFile) => void\r\n  onError?: (file: IndexedFile, code: number, detail: Object | void) => void\r\n  onAbort?: (file: IndexedFile) => void\r\n\r\n  onProgress?: (file: IndexedFile, progress: type.UploadProgress) => void\r\n  onSuccess?: (file: IndexedFile, responseText: string) => void\r\n}\r\n\r\nexport default class Supload {\r\n\r\n  swf: Element\r\n\r\n  movieName: string\r\n\r\n  hooks: SuploadHooks\r\n\r\n  debug: boolean\r\n\r\n  public static instances = {}\r\n\r\n  /**\r\n   * 文件状态 - 等待上传\r\n   */\r\n  public static STATUS_WAITING = 0\r\n\r\n  /**\r\n   * 文件状态 - 正在上传\r\n   */\r\n  public static STATUS_UPLOADING = 1\r\n\r\n  /**\r\n   * 文件状态 - 上传成功\r\n   */\r\n  public static STATUS_UPLOAD_SUCCESS = 2\r\n\r\n  /**\r\n   * 文件状态 - 上传失败\r\n   */\r\n  public static STATUS_UPLOAD_ERROR = 3\r\n\r\n  /**\r\n   * 错误码 - 上传中止\r\n   */\r\n  public static ERROR_ABORT = 0\r\n\r\n  /**\r\n   * 错误码 - 上传出现沙箱安全错误\r\n   */\r\n  public static ERROR_SECURITY = 1\r\n\r\n  /**\r\n   * 错误码 - 上传 IO 错误\r\n   */\r\n  public static ERROR_IO = 2\r\n\r\n  constructor(options: SuploadOptions, hooks: SuploadHooks = {}) {\r\n\r\n    const movieName = createMovieName()\r\n\r\n    const swf = createSWF(\r\n      movieName,\r\n      options.swfUrl,\r\n      createFlashVars(movieName, options.accept || '', options.multiple || false)\r\n    )\r\n\r\n    const { el } = options\r\n    if (el.parentNode) {\r\n      el.parentNode.replaceChild(swf, el)\r\n    }\r\n    else {\r\n      throw new Error('el.parentNode is not found.')\r\n    }\r\n\r\n    this.swf = swf\r\n    this.movieName = movieName\r\n    this.hooks = hooks\r\n    this.debug = !!options.debug\r\n\r\n    Supload.instances[movieName] = this\r\n\r\n  }\r\n\r\n  /**\r\n   * 获得要上传的文件\r\n   */\r\n  getFiles() {\r\n    return this.swf['getFiles']()\r\n  }\r\n\r\n  /**\r\n   * 上传\r\n   */\r\n  upload(index: number, options: type.UploadOptions) {\r\n    this.swf['upload'](index, options.action, options.fileName, options.data, options.headers)\r\n  }\r\n\r\n  /**\r\n   * 取消上传\r\n   */\r\n  abort(index: number) {\r\n    this.swf['abort'](index)\r\n  }\r\n\r\n  /**\r\n   * 启用鼠标点击打开文件选择窗口\r\n   */\r\n  enable() {\r\n    this.swf['enable']()\r\n  }\r\n\r\n  /**\r\n   * 禁用鼠标点击打开文件选择窗口\r\n   */\r\n  disable() {\r\n    this.swf['disable']()\r\n  }\r\n\r\n  /**\r\n   * 销毁对象\r\n   */\r\n  destroy() {\r\n    this.swf['destroy']()\r\n    Supload.instances[this.movieName] = null\r\n    // 清除 IE 引用\r\n    window[this.movieName] = null\r\n  }\r\n\r\n  onReady() {\r\n    // swf 文件初始化成功\r\n    const { onReady } = this.hooks\r\n    if (onReady) {\r\n      onReady()\r\n    }\r\n  }\r\n\r\n  onFileChange() {\r\n    // 用户选择文件\r\n    const { onFileChange } = this.hooks\r\n    if (onFileChange) {\r\n      onFileChange()\r\n    }\r\n  }\r\n\r\n  onStart(data: FlashFile) {\r\n    const { onStart } = this.hooks\r\n    if (onStart) {\r\n      onStart(data.file)\r\n    }\r\n  }\r\n\r\n  onEnd(data: FlashFile) {\r\n    const { onEnd } = this.hooks\r\n    if (onEnd) {\r\n      onEnd(data.file)\r\n    }\r\n  }\r\n\r\n  onError(data: FlashError) {\r\n    const { onError } = this.hooks\r\n    if (onError) {\r\n      onError(data.file, data.code, data.detail)\r\n    }\r\n  }\r\n\r\n  onAbort(data: FlashFile) {\r\n    const { onAbort } = this.hooks\r\n    if (onAbort) {\r\n      onAbort(data.file)\r\n    }\r\n  }\r\n\r\n  onProgress(data: FlashProgress) {\r\n    const { onProgress } = this.hooks\r\n    if (onProgress) {\r\n      const { file, uploaded, total } = data\r\n      onProgress(\r\n        file,\r\n        {\r\n          uploaded,\r\n          total,\r\n          percent: total > 0 ? uploaded / total : 0\r\n        }\r\n      )\r\n    }\r\n  }\r\n\r\n  onSuccess(data: FlashSuccess) {\r\n    const { onSuccess } = this.hooks\r\n    if (onSuccess) {\r\n      onSuccess(data.file, data.responseText)\r\n    }\r\n  }\r\n\r\n  onDebug(data: FlashDebug) {\r\n    if (this.debug) {\r\n      console.log(data.text)\r\n    }\r\n  }\r\n\r\n}\r\n\r\n/**\r\n * 项目名称 AS 会用 projectName.instances[movieName] 找出当前实例\r\n */\r\nconst projectName = 'Supload'\r\n\r\n/**\r\n * 暴露给全局的对象，这样 AS 才能调到\r\n */\r\nwindow[projectName] = Supload\r\n\r\n/**\r\n * guid 初始值\r\n */\r\nlet guid = 0\r\n\r\n/**\r\n * 创建新的唯一的影片剪辑名称\r\n */\r\nfunction createMovieName() {\r\n  return '_supload_' + (guid++)\r\n}\r\n\r\n/**\r\n * 创建 swf 元素\r\n *\r\n * 无需兼容 IE67 用现有方法即可\r\n *\r\n * 如果想兼容 IE67，有两种方法：\r\n *\r\n * 1. 把 wmode 改成 opaque\r\n * 2. 用 swfobject 或别的库重写此方法\r\n *\r\n * 这里不兼容 IE67 是因为要判断浏览器实在太蛋疼了。。。\r\n */\r\nfunction createSWF(id: string, swfUrl: string, flashVars: string) {\r\n\r\n  const div = document.createElement('div')\r\n\r\n  // 不加 ID 在 IE 下没法运行\r\n  div.innerHTML = '<object id=\"' + id + '\" class=\"' + projectName.toLowerCase()\r\n    + '\" type=\"application/x-shockwave-flash\" data=\"' + swfUrl + '\">'\r\n    + '<param name=\"movie\" value=\"' + swfUrl + '\" />'\r\n    + '<param name=\"allowscriptaccess\" value=\"always\" />'\r\n    + '<param name=\"wmode\" value=\"transparent\" />'\r\n    + '<param name=\"flashvars\" value=\"' + flashVars + '\" />'\r\n    + '</object>'\r\n\r\n  return div.children[0]\r\n\r\n}\r\n\r\n/**\r\n * 拼装给 swf 用的参数\r\n */\r\nfunction createFlashVars(movieName: string, accept: string, multiple: boolean) {\r\n\r\n  const result = [\r\n    'projectName=' + projectName,\r\n    'movieName=' + movieName,\r\n    'accept=' + encodeURIComponent(accept),\r\n    'multiple=' + (multiple ? 'true' : 'false')\r\n  ]\r\n\r\n  return result.join('&amp;')\r\n\r\n}\r\n\r\n\r\n\r\n"],"names":["const","let"],"mappings":"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"}